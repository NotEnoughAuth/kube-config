
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: auvik-collector
  namespace: auvik
  labels:
    app: auvik-collector
spec:
  replicas: 1
  selector:
    matchLabels:
      app: auvik-collector
  template:
    metadata:
      labels:
        app: auvik-collector
    spec:
      restartPolicy: Always
      containers:
        - name: auvik-collector
          image: auviknetworks/collector:latest
          env:
          - name: AUVIK_USERNAME
            value: "opryga@oplabs.us"
          - name: AUVIK_DOMAIN_PREFIX
            value: "oplabshq"
          - name: AUVIK_API_KEY
            value: "47735ba6-44c6-4148-8ddd-54e1edf697e4"
          resources:
            requests:
              memory: "4Gi"
              cpu: "2"
            limits:
              memory: "4Gi"
              cpu: "2"
          volumeMounts:
              - name: config
                mountPath: /config/
              - name: etcauvik
                mountPath: /etc/auvik/
              - name: logs
                mountPath: /usr/share/agent/logs/
    volumeClaimTemplates:
      - metadata:
          name: config
        spec:
          accessModes: [ "ReadWriteOnce" ]
          resources:
            requests:
              storage: 16Mi
      - metadata:
          name: etcauvik
        spec:
          accessModes: [ "ReadWriteOnce" ]
          resources:
            requests:
              storage: 32Mi
      - metadata:
          name: logs
        spec:
          accessModes: [ "ReadWriteOnce" ]
          resources:
            requests:
              storage: 16Gi
  